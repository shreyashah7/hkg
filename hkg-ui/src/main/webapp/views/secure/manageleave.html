<div ng-if="canAccess('manageLeave')">
    <div class="row">
        <div class="col-xs-12"> 
            <!--breadcrumb-->
            <div class="col-xs-12 breadcrumb-bg" >
                <div class="col-xs-12 col-lg-8">
                    <ol class="breadcrumb">
                        <li>{{ entity + 'You are here' | translate}}</li>
                        <li>{{ entity + 'Manage' | translate}}</li>
                        <li >{{ entity + 'Leaves' | translate}}</li>                    
                        <!--                        <li class="active" ng-click="setManageLeaveOperation('manageLeave')">{{ entity + "Manage Leaves" | translate }}</li>-->
                        <li class="active" ng-if="manageLeaveOperation === 'respondLeave'">{{ entity + "Respond Leave" | translate }}</li>
                    </ol>
                </div>

            </div>
            <!--breadcrumb-->

            <div ng-class="{'col-xs-9' : manageLeaveOperation === 'respondLeave','col-xs-12' : manageLeaveOperation !== 'respondLeave'}" class=" new-panel">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="col-xs-12 col-lg-12 well well-sm">
                            <div class="input-group " ng-init="setManageLeaveOperation('manageLeave')" >
                                <div id="scrollable-dropdown-menu">
                                    <input  class="typeahead" type="text"  placeholder="Search leave by employee, reason,date" 
                                            ag-search="{{apipath}}leave/searchLeaveForApprover" 
                                            result-format="requestFrom,reason,fromDate" 
                                            search-list-array='searchedApproverList'
                                            on-select="redirectToRespondLeave"
                                            on-enter="redirectToSearchePage"
                                            id="scrollable-dropdown-menu"/>
                                </div>
                                <span class="input-group-btn">
                                    <button class="btn btn-default btn-hkg" ng-click="redirectToSearchePage(searchedApproverList)" type="button"><span class="glyphicon glyphicon-search"></span></button>
                                </span>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div id="messages" ng-include src="'templates/messages.html'">
                            </div>
                        </div>

                        <div class="col-xs-12 col-lg-12" ng-if="manageLeaveOperation === 'manageLeave' && manageLeaveOperation !== 'searchedLeave'">
                            <h4>{{ entity + 'Approvals List' | translate }}</h4>
                            <div class="pull-right" >
                                <input type="checkbox" ng-model="isChecked" ng-click="retrieveApprovalByCondition(!isChecked)">{{ entity + 'Show All' | translate}} </input>
                            </div>
                            <div ng-if="records.length === 0">
                                <div class="col-lg-12 col-md-12 col-xs-12">
                                    <table class="table table-bordered" >
                                        <tr>
                                            <td class="col-md-12">
                                                {{ entity + 'No leave applyed  yet' | translate }}
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div ng-if="records.length > 0">
                                <table class="table" ag-data-table="records" >
                                    <thead>
                                        <tr>
                                            <th  style=" white-space: nowrap;"> {{ entity + 'Request From' | translate}}</th>
                                            <th>{{ entity + 'Department' | translate}}</th>
                                            <th>{{ entity + 'Reason' | translate}}</th>
                                            <th>{{ entity + 'Dates' | translate}}</th>
                                            <th>{{ entity + 'Days' | translate}}</th>
                                            <th  style=" white-space: nowrap;">{{ entity + 'Request Type' | translate}}</th>
                                            <th>{{ entity + 'Action' | translate}}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="record in records" dt-rows>
                                            <td><a href="" ng-click="retrieveAllleaveByUserId(record)">{{record.requestFrom}}</a></td>
                                            <td><span class="wordRap" ng-bind="record.department"></span></td>
                                            <td><span class="wordRap" ng-bind="record.reason"></span></td>
                                            <td>{{record.fromDate| date:" dd/MM/yyyy"}}-{{record.toDate| date:" dd/MM/yyyy"}}</td>
                                            <td align="center">{{record.days}}</td>
                                            <td>{{record.requestType}}</td>
                                            <td>
                                                <div ng-show="record.status == 'Pending' && record.requestType == 'Leave'"><a href="" ng-click="setManageLeaveOperation('respondLeave', record)">{{ entity + 'Respond' | translate}}</a></div>
                                                <div ng-show="record.requestType == 'Cancellation'"><a href="" ng-click="setManageLeaveOperation('respondLeave', record, true)">{{ entity + 'Respond' | translate}}</a></div>
                                                <div ng-show="record.status != 'Pending' && record.requestType != 'Cancellation'">{{record.status}}</div>
                                            </td>

                                        </tr>
                                    </tbody>

                                </table>
                            </div>
                        </div>

                        <div ng-if="manageLeaveOperation === 'respondLeave'">
                            <div ng-include src="'views/secure/respondleave.html'"></div>
                        </div>
                        <div ng-if="manageLeaveOperation === 'searchedApprover'">
                            <div ng-include src="'views/secure/searchemanageleave.html'"></div>
                        </div>
                        <!-- input-group --> 
                    </div>
                </div>
            </div>
            <div class="col-md-3 tree-bg " ng-if="manageLeaveOperation === 'respondLeave'">
                <div  class="col-xs-12  fit-content"><span class="glyphicon glyphicon-circle-arrow-down text-hkg "></span>&nbsp;&nbsp;<span class="text-hkg"><strong>{{entity + "Pending stock"| translate}}</strong></span>
                    <hr class="margin-md"/>
                    <div class="col-xs-12">
                        <div class="input-group">
                            <input class="form-control" ng-model='treeSearchQuery' type="text" placeholder="Search"/>
                            <div class="input-group-addon" ><span class="glyphicon glyphicon-search"></span></div>
                        </div>
                    </div>
                    <!--Tree component starts-->
                    <div class="col-xs-12 hkg-nopadding">
                        <br/>
                        <div ng-show="pendingStockList.length > 0"
                             data-angular-treeview="true"
                             data-tree-id="selectedDesignation"
                             ag-treemodel="stockList" entity-name="APPLYLEAVE." 
                             data-search-query='treeSearchQuery'>
                        </div>
                    </div>
                    <!--Tree component ends--> 
                    <div ng-show="designationList.length === 0">
                        No pending stock
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    </div>






    <!--<h3>{{ entity + 'Manage Leaves' | translate}}</h3>
    <fieldset class="hkg-fieldset">
    </fieldset>
    <br><br>
    <div class="row" ng-init="setManageLeaveOperation('manageLeave')">
        <div class="col-md-8 well well-sm ">
            <input class="form-horizontal col-md-11" placeholder="Search leaves by employee,reason,date.." type="search" />
            &nbsp;&nbsp;<i class="glyphicon glyphicon-search icon-large pull-right"></i>
        </div>
    </div>
    <div id="messages" ng-include src="'templates/messages.html'"></div>
    <div ng-if="manageLeaveOperation === 'manageLeave'">
        <h4>Approvals list</h4>
        <div class="pull-right" ng-show="records.length > 0">
            <input type="checkbox" ng-model="isChecked" ng-click="retrieveApprovalByCondition(!isChecked)">{{ entity + 'Show All' | translate}} </input>
        </div>
        <div ng-show="!(records.length > 0)">
            {{ entity + 'No leave applyed  yet' | translate }}
        </div>
        <table class="table" cellspacing="0" width="100%" ag-data-table="records" ng-show="records.length > 0">
            <thead>
                <tr>
                    <th>Request from</th>
                    <th>Department</th>
                    <th>Reason</th>
                    <th>Dates</th>
                    <th>Days</th>
                    <th>Request type</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="record in records" dt-rows>
                    <td><a href="" ng-click="retrieveAllleaveByUserId(record)">{{record.requestFrom}}</a></td>
                    <td>{{record.department}}</td>
                    <td>{{record.reason}}</td>
                    <td>{{record.fromDate| date:" dd/MM/yyyy"}}-{{record.toDate| date:" dd/MM/yyyy"}}</td>
                    <td>{{record.days}}</td>
                    <td>{{record.requestType}}</td>
                    <td>
                        <div ng-show="record.status == 'Pending' && record.requestType == 'Leave'"><a href="" ng-click="setManageLeaveOperation('respondLeave', record)">{{ entity + 'Respond' | translate}}</a></div>
                        <div ng-show="record.requestType == 'Cancellation'"><a href="" ng-click="cancelApproveLeave(record)">{{ entity + 'Archive' | translate}}</a></div>
                        <div ng-show="record.status != 'Pending'">{{record.status}}</div>
                    </td>
    
                </tr>
            </tbody>
    
        </table>
    </div>
    
    <div ng-if="manageLeaveOperation === 'respondLeave'">
        <div ng-include src="'views/secure/respondleave.html'"></div>
    </div>-->
    <div class="modal fade" id="employeeLeavePopup">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <a class="close" ng-click="proceedCancel()">&times;</a>
                    <h4 class="modal-title">
                        {{ entity + 'Leave Details For ' | translate}}
                    </h4>
                    <center> {{entity + empName|translate}} </center>


                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div ng-if="leaveResponse" class="table-responsive">
                            <table class="table" width="100%" ag-data-table="allUserLeaves" >
                                <thead>
                                    <tr>
                                        <th>{{ entity + 'Department' | translate}}</th>
                                        <th>{{ entity + 'Reason' | translate}}</th>
                                        <th>{{ entity + 'From' | translate}}</th>
                                        <th>{{ entity + 'Days' | translate}}</th>
                                        <th  style=" white-space: nowrap;">{{ entity + 'Request Type' | translate}}</th>
                                        <th>{{ entity + 'Action' | translate}}</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="record in allUserLeaves" dt-rows>
                                        <td><span class="wordRap" ng-bind="record.department"></span></td>
                                        <td><span  class="wordRap" ng-bind="'LR.' + record.reason | translate"></span></td>
                                        <td>{{record.fromDate| date:" dd/MM/yyyy"}}-{{record.toDate| date:" dd/MM/yyyy"}}</td>
                                        <td align="center">{{record.days}}</td>
                                        <td>{{record.requestType}}</td>
                                        <td>
                                            <div ng-show="record.status == 'Pending'"><a href="" ng-click="setManageLeaveOperation('respondLeave', record)">Respond</a></div>
                                            <div ng-show="record.status != 'Pending'">{{record.status}}</div>
                                        </td>

                                    </tr>
                                </tbody>

                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href=""  ng-click="proceedCancel()">
                        {{ entity + 'Cancel'| translate}}
                    </a>
                    <button class="btn btn-hkg" ng-click="proceedOk()">
                        {{ entity + 'Ok' | translate}}
                    </button>

                </div>
            </div>
        </div>
    </div>
</div>
<div ng-if="!canAccess('manageLeave')">
    you have no authorization for this page.
</div>
